# 主动防御设计案（设计阶段）

主动防御是指房间的 tower 防御机制无法有效的消灭敌人时孵化 creep 进行反击和增强维修的功能。

## 日常模式

- tower 每隔一段时间搜索一下房间内的敌人，如果发现敌人则每 tick 进行攻击直至房间内不存在敌人。
- 如果不存在敌人的话则每隔一段时间选择一个 tower 刷下墙。

## 模式切换（日常 > 主动）

tower 在攻击敌人后会检查是否可以破防，如果无法破防则将房间防御模式切换成主动模式。

## 主动模式

下列步骤将会依次进行

- 房间进入战争状态，通知 transfer 搬运强化化合物。
- tower 放弃攻击敌方单位，转而维修受到攻击的墙体。
- 发布维修工，主动维修受到攻击的墙体。
- 化合物搬运完成后发布 Defender 单位，主动进攻敌人。
- Defender 孵化完成后 tower 将目标切换至治疗 Defender。

## 模式切换（主动 > 日常）

- tower 没有发现有墙体被攻击
- tower 没有找到有敌人
- 时间持续 100t

以上三个条件均满足则切换至日常模式并解除战争状态

# 破防检查

- 如果敌人是入侵者则不进行破防检查